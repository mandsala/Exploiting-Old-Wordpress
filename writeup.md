# Wordpress Exploitation
Submission for WordPress Vs. Kali Linux Assignment



Vulnerability & Exploit Found #1:
CVE-2015-3440

Steps Taken: 

This version of WordPress is vulnerable to JavaScript injection attacks in the WordPress comments. 
•If the comment text exceeds WordPress’s MySQL TEXT type size of 64 kilobytes, an attacker can leverage the vulnerability to execute arbitrary code
•The following was done:
1.	Inserted the following the script so that whenever any users viewed the comment, they would be prompted by a “hello world” pop-up while they stayed on the page 
    a.	“<  a title='x onmouseover=alert(unescape(/hello%20world/.source)) style=position:absolute;left:0;top:0;width:5000px;height:5000px  AAAAAAAAAAAA...[64 kb]..AAA'>         </a>”
2.	Adjusted the script to have enough “AAA”s to exceed the 64 kb limit
3.	Visited the page with the comment as Admin

Class of vulnerability: Unauthenticated Stored Cross-Site Scripting

Vulnerable to: Wordpress 4.2, 4.1.2, 4.1.1, 3.9.3

Patched: 4.2.1

Source Code: 
•	src/wp-includes/wp-db.php

•	Screen Cap:  

![vuln1](https://user-images.githubusercontent.com/112013474/198405220-17b4ecdc-2da0-46df-9339-ae63a1403103.png)


    ----------------------------------------------------------


Vulnerability & Exploit Found #2:
CVE-2015-5622

Steps Taken:

This version of WordPress is vulnerable to authenticated users under the Author or Contributor role injecting arbitrary web script or HTML inside within posts and pages.
  •	In this case, the HTML script injected within the source code prompted any users that loaded the post with an alert saying “test”
  •	The following was done:
1.	Had a user with the role of “Author” create a new post
2.	Within the description of post during editing, right clicked the text box to inspect the HTML code and under the body, inserted the following scripts 
  a.	<(a) href="[caption code=" data-mce-href="[caption code=">]<(/a)>
  b.	<(a) title=" onmouseover=alert('test')  ">(link)<(/a)>
3.	Used with ‘Edit As HTML’ while inspecting source code
4.	Loaded up the created post to be prompted by an alert run by the script 

Class of Vulnerability: cross-site scripting

Vulnerable to: any WordPress versions before 4.2.3

Patched: On version 4.2.3

Source Code:
  •	src/wp-includes/class-wp-embed.php 
  •	src/wp-includes/formatting.php 
  •	src/wp-includes/kses.php 
  •	src/wp-includes/shortcodes.php 
  
Screen Cap:
 
![vuln2](https://user-images.githubusercontent.com/112013474/198405384-52691df0-3e90-41b4-b9f6-cc7726c5705d.png)


    ----------------------------------------------------------


Vulnerability & Exploit Found #3:
CVE-2016-4566

Steps Taken:

This version of WordPress is vulnerable to cross-site scripting (XSS) in plupload.flash.swf. It allows authenticated (primarily admins) attackers to inject arbitrary web script or HTML via a Same-Origin Method Execution (SOME) attack.
  •	I had two authenticated users, one as an author and admin, both try exploiting this vulnerability
  •	The following was done:
1.	I had both users leave the following script as a comment under a post
  ‘’’ <button onclick="fire()">Click</button>
  <script>
  function fire() {
   open('javascript:setTimeout("location=\'http://example.com/wp-includes/js/plupload/plupload.flash.swf?                target%g=opener.document.body.firstElementChild.nextElementSibling.nextElementSibling.nextElementSibling.firstElementChild.click&uid%g=hello&\'", 2000)');
   setTimeout('location="http://example.com/wp-admin/plugin-install.php?tab=plugin-information&plugin=wp-super-cache&TB_iframe=true&width=600&height=550"')
  }
  </script> ‘’’
2.	This script created a clickable button on the user’s end of browsing the post, and it will redirect the user to a different site while attempting to install malware

Class of Vulnerability: Cross-site Scripting (XSS)

Vulnerable to: Versions of WordPress before 4.5.2

Patched on: 4.5.2

Sourcecode: https://core.trac.wordpress.org/browser/branches/4.5/src/wp-includes/js/plupload/plupload.flash.swf?rev=37382 

Screencaps:

 ![Desktop Screenshot 2022 10 27 - 11 57 38 04](https://user-images.githubusercontent.com/112013474/198405687-d5ba25c8-34e5-4dfe-a514-68bdef7dbccf.png)
(Admin comment compared to Author comment)

 
![Desktop Screenshot 2022 10 27 - 11 58 17 81](https://user-images.githubusercontent.com/112013474/198405712-449db21c-e194-4ed8-8a27-78dbd556a9b1.png)
(redirected page when button is clicked on user end)


    ----------------------------------------------------------
    
GIF DEMONSTRATIONS

Vulnerability Exploited #1:


![vulnerability1](https://user-images.githubusercontent.com/112013474/198405990-995be7e3-95c0-437e-ab7e-434ad759bffa.gif)



Vulnerability Exploited #2:


![vulnerability2](https://user-images.githubusercontent.com/112013474/198406018-4ec9d9e6-ddaa-4e87-90c0-8df84cafa81f.gif)


Vulnerability Exploited #3:

![vulnerability3](https://user-images.githubusercontent.com/112013474/198406060-3c470c89-eb1d-4512-983e-bae6daec2ae2.gif)


